{% extends "base.html" %}
{% block content %}
<h2>{{ question.title }}</h2>
<div class="meta">작성자: {{ question.author.username if question.author else '익명' }} | {{ question.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
<p>{{ question.content }}</p>
{% if question.image %}
  <p><img src="{{ url_for('uploaded_file', filename=question.image) }}" class="bigimg"></p>
{% endif %}

<hr>
<h3>답변</h3>
{% for a in question.answers %}
  <div class="answer">
    <p>{{ a.content }}</p>
    <div class="meta">
      작성자: {{ a.author.username if a.author else '익명' }} | {{ a.created_at.strftime('%Y-%m-%d %H:%M') }}
      {% if a.is_accepted %} <strong class="is-accepted">[채택됨]</strong>{% endif %}
    </div>
    {% if session.get('user_id') and session.get('user_id') == question.user_id and not a.is_accepted %}
      <p><a href="{{ url_for('accept_answer', answer_id=a.id) }}" class="button">이 답변 채택</a></p>
    {% endif %}
  </div>
  {% if not loop.last %}<hr>{% endif %}
{% else %}
  <p>아직 답변이 없습니다.</p>
{% endfor %}

<h4>답변하기</h4>
<form method="post">
  {{ form.hidden_tag() }}
  <p>{{ form.content(class='form-input', rows=4) }}</p>
  <p>{{ form.submit(class='button') }}</p>
</form>
{% endblock %}